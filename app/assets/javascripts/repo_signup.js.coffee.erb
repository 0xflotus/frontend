poller = () ->
  $.getJSON("/add-repo/dynamic",
    (data, textStatus) ->
      alert data["state"]
      ready = data["ready"]
      if ready?
        if ready
          adjust_page(data["step"], data["substep"], data["rendering"])
        setTimeout(poller, 200)
  )

adjust_page = (step, substep, rendering) ->
  alert("adjusting")
  alert(substep)
  alert(step)
  alert(rendering)

$(document).ready ->
  setTimeout(poller, 200)
